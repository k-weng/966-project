<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Instructions</title>
<style>
 
#object1 {
  position: absolute;
  top: -500px;
  left: -500px;
}
 
#object2 {
  position: absolute;
  top: -500px;
  left: -500px;
}
 
#object3 {
  position: absolute;
  top: -500px;
  left: -500px;
} 
 
#object4 {
  position: absolute;
  top: -500px;
  left: -500px;
} 
 
#object5 {
  position: absolute;
  top: -500px;
  left: -500px;
} 
 
#fixationcross {
  position: absolute;
  top: -500px;
  left: -500px;
}
 
#task_container { 
 position: relative;
 text-align: center; 
 font-size: 110%; 
 width: 370px; 
 height: 280px; 
 top: 80px;
 left: 510px;
 background: black;
}
 
#page_container { 
 align:center; 
 width: 100%;
 height: 100%;
}
 
#background_container { 
 background: black;
 position: relative;
 background-image: url("webfile/precarious_laptop_web.jpg");
 background-repeat: no-repeat;
 background-position: center;
 text-align:center; 
 align:center; 
 font-size: 110%; 
 width: 100%; 
 height: 761px;
}
 
</style>
</head>
 
<body onload="load()">

<div id = "page_container"> 
  <div id="background_container">
  
    <br><b>LET'S PRACTICE</b><br><br>
    Here is an example of what you will see.<br><br>
 
    <div id="task_container">
       <!-- the area in which the MOT is dislayed -->
    </div>
   
    <div id="fixationcross"><img src="webfile/fixation.png" width = "18px" /></div> 
    <!-- <div id='object1'><img src='webfile/object.png' width = '20px' onclick='targetclicked(event)'/></div> -->
 </div>
  
 <br>
 <!-- <div id='mesage'></div> -->
 <form name="frm" action="experiment.php" method="post" onsubmit="return validateForm()">
   <input type="text" name="UID" hidden>
   <input type="text" name="firsttrial" hidden><input type="submit" value="Continue" hidden/>
 </form>
  
<div>
</body>

<script>

// ---------------------------------------------------------------------------------------------------
//
//       variables for animation control 
//
// --------------------------------------------------------------------------------------------------- 

var frameTiming = 100;           // time im milliseconds between frames - set this variable to control the speed of animation
var frame_index = 0;             // where are we in the animation?
var num_fixation_frames = 5;     // for how many frames to show fixation cross 
var num_moving_frames = 50;      // how long should the tracking animation last
var num_blink_frames = 10;       // how long the blinking animtion lasts
var waiting_for_response = 0;    // 1 if the trial finished and the subject has to click on the objects
var repulsion_radius = 20;       // object orbit 
 
var num_objects = 5;             // how many objects do we want to show
var num_targets = 3;             // how many targets do we want to show
var object_x = [];               // object coordinates
var object_y = []; 
 
 
function load() {
 
     var background_width = document.getElementById("background_container").offsetWidth;
     var background_height = document.getElementById("background_container").offsetHeight;
     
     var MOT_width = document.getElementById("task_container").offsetWidth;
     var MOT_height = document.getElementById("task_container").offsetHeight;

     // alert(container_width + " " + container_height);
    
     
     var h = document.getElementById("background_container").innerHTML;    // adding objects
      
     for (i = 0; i < num_objects; i++) {
      
        object_x.push(  Math.random()*(MOT_width -repulsion_radius*2) + repulsion_radius );
        object_y.push(  Math.random()*(MOT_height-repulsion_radius*2) + repulsion_radius ); 
         
        var idx = i+1; 
        var clickfun = "targetclicked";
        
        if (i > num_targets-1) {
           clickfun = "distractorclicked";
        }
         
        h = h + "<div id='object" + idx + 
                "'><img src='webfile/object.png' width = '20px' onclick='" + clickfun + 
                "(event)'/></div>"; 
     }
     
     document.getElementById("background_container").innerHTML = h;
      
     // show fixation cross  
     document.getElementById("fixationcross").style.left = MOT_width/2 +"px";
     document.getElementById("fixationcross").style.top  = MOT_height/2 +"px";
      
     setTimeout(nextFrame, frameTiming); 
}

function targetclicked(event) {
}
 
function distractorclicked(event) {
}  
  
// ------------------------------------------------------------------------ 
//  
//      animate objects 
//
// ------------------------------------------------------------------------
  
function check_constraints() { 
}
  
function init_object_positions() {
    var offx = document.getElementById("task_container").offsetLeft;
    var offy = document.getElementById("task_container").offsetTop;
  
    for (i = 0; i < object_x.length; i++) {
       var idx =  i+1;
       var obj = "object" + idx;
       document.getElementById(obj).style.left = offx + object_x[i]+"px";
       document.getElementById(obj).style.top = offy + object_y[i]+"px";
    }
}
                                
function reset_object_positions() {
    for (i = 0; i < object_x.length; i++) {
       var idx =  i+1;
       var obj = "object" + idx;
       document.getElementById(obj).style.left = "-500px";
       document.getElementById(obj).style.top = "-500px";
    }
}                                
  
function nextFrame() {

  if (frame_index < num_fixation_frames) {
     // fixation cross
      
  } else if (frame_index == num_fixation_frames) {
    
    // remove fixation cross   
    document.getElementById("fixationcross").style.left = "-500px";
    document.getElementById("fixationcross").style.top = "-500px";
      
    // initialise object positions 
    init_object_positions();
     
  } else if (frame_index < num_fixation_frames + num_blink_frames) {
   
    // draw blinking of the target objects
    if ( frame_index % 2 == 0 ) {
       reset_object_positions();  
    } else {
       init_object_positions();
    }
     
  } else if (frame_index < num_fixation_frames + num_blink_frames + num_moving_frames) {
   
    // draw moving animation
      
  } else {
   waiting_for_response = 1;  // no more frames, waiting for response
   return;
  }
   
   frame_index++;  
   setTimeout(nextFrame, frameTiming);  
}
 
function validateForm() {
    document.forms["frm"]["UID"].value = u_id;
    document.forms["frm"]["firsttrial"].value = "true";
    return true;  
}
   
</script>
</html>
